<div class="jumbotron text-center">
    <section class="content">
        <section class="container-fluid">
          <h2>Events</h2>
          <!-- TIFF: Copied from lessons - needs wired up! -->
            <div class="input-group col-md-6 col-md-offset-3">
                <span class="input-group-addon">
                    <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                </span>
                <input type="text" class="form-control" ng-model="vm.filter.searchString" ng-change="vm.searchChange()"
                placeholder="Search for an Event by name, date, description...">
            </div>
            <div class="alert alert-danger text-center" ng-show="vm.error">
              <p ng-bind="vm.error"></p>
            </div>
            <div class="alert alert-info text-center" ng-show="vm.events.length === 0 && vm.filter.searchString !== '' && !vm.error">
                Sorry, no results found for that search term
            </div>
        </section>
    </section>
</div>
<section class="content">
    <section class="container-fluid">
        <nav class="navbar">
            <a class="btn btn-default pull-right" ui-sref="events.create" view-permissions="admin">
                <i class="glyphicon glyphicon-plus"></i> Create an event
            </a>
            <!--TIFF: Copied from lessons - needs wired up! -->
            <ul class="nav navbar-nav">
                <li><a ng-click="vm.clearFilters()" ok-sel="*">Show All</a></li>
                <li class="dropdown" id="category">
                    <a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                        Type{{(vm.filter.category) ? ': ' + vm.filter.category : ''}} <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                      <li><a ng-click="vm.categorySelected()" ok-sel=".all">All</a></li>
                      <li role="separator" class="divider"></li>
                      <li>
                        <a><i class="fa fa-circle" style="color:#607D8B"></i> ORS Basic Training</a>
                        <a><i class="fa fa-circle" style="color:#00BCD4"></i> Advanced Field Training</a>
                        <a><i class="fa fa-circle" style="color:#795548"></i> Professional Development</a>
                        <a><i class="fa fa-circle" style="color:#4CAF50"></i> Scientist Workshop</a>
                        <a><i class="fa fa-circle" style="color:#9E9E9E"></i> Other</a>
                      </li>
                    </ul>
                </li>
                <li class="dropdown" id="date">
                    <a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                        Date{{(vm.filter.date) ? ': ' + vm.filter.date : ''}}  <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                      <li><a ng-click="vm.categorySelected()" ok-sel=".all">All</a></li>
                      <li role="separator" class="divider"></li>
                      <li>
                        <a>Upcoming events</a> <!-- TIFF: Should be default -- includes day of -->
                        <a>Past events</a>
                      </li>
                    </ul>
                </li>
                <li class="dropdown" id="date">
                    <a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                        Availability{{(vm.filter.availability) ? ': ' + vm.filter.availability : ''}}  <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                      <li><a ng-click="vm.categorySelected()" ok-sel=".all">All</a></li>
                      <li role="separator" class="divider"></li>
                      <li>
                        <a>Registration open</a>
                        <a>Registration closed</a>
                      </li>
                    </ul>
                </li>
            </ul>
        </nav>
        <div class="row" isotope-container="isotope-container" id="lesson-list-isotope-container">
            <div isotope-item="isotope-item" ng-repeat="calendarEvent in vm.events" class="col-xs-12 col-sm-6 col-md-4 col-lg-3 library-item">
                <div class="panel" data-category="transition" ui-sref="events.view({ eventId: calendarEvent._id })">
                    <div class="panel-heading" ng-style="{'background-color':'{{category.type.color}}'}">
                        <!--TIFF: I got this to work but it's currently all lowercase? Also wire up category.type.color as panel-heading background -->
                        <h3 class="panel-title" ng-bind="calendarEvent.category.type"></h3>
                    </div>
                    <div class="panel-body text-center">
                        <h3 class="blue" ng-repeat="date in calendarEvent.dates">{{vm.getEventDate(date.startDateTime)}} <small>
                          {{vm.getEventYear(date.startDateTime)}}<br/>
                          {{vm.getEventTimeRange(date.startDateTime, date.endDateTime)}}</small></h3>
                        <h4><b class="red" ng-bind="calendarEvent.title"></b></h4>
                        <p ng-show="calendarEvent.location.addressString"><i class="fa fa-map-marker"></i> {{calendarEvent.location.addressString}}</p>
                    </div>
                    <div class="panel-footer">
                        <p class="text-muted text-center small">
                            <span ng-show="vm.getOpenSpots(calendarEvent.registrants, calendarEvent.maximumCapacity)">
                              <i class="fa fa-calendar-times-o"></i>
                              <b>{{vm.getOpenSpots(calendarEvent.registrants, calendarEvent.maximumCapacity)}} spots</b> and </span>
                            <span ng-show="(calendarEvent.dates && calendarEvent.dates.length > 0) ||
                              calendarEvent.deadlineToRegister">
                              <i class="fa fa-clock-o"></i>
                              <b>{{vm.getDaysRemaining(calendarEvent.dates, calendarEvent.deadlineToRegister)}} days</b> remaining</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="alert" ng-if="vm.events.$resolved && !vm.events && vm.events.length === 0" view-permissions="admin">
            No events yet, why don't you <a ui-sref="events.create">create one</a>?
        </div>
    </section>
</section>
