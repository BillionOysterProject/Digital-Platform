<div class="jumbotron text-center">
  <section class="content">
    <section class="container-fluid">
      <h2>My Collection</h2>
    </section>
  </section>
</div>
<section class="content">
  <section class="container-fluid">
    <div>
      <a class="btn btn-default pull-right" ui-sref="researches.create">
        <i class="glyphicon glyphicon-plus"></i> Create new poster
      </a>
      <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" ng-class="{active: vm.createdResearches.length > 0}">
          <a href="#created" aria-controls="grid" role="tab" data-toggle="tab" ng-click="vm.switchTab('created')">Created Posters</a>
        </li>
        <li role="presentation" view-permissions="admin,team lead" ng-class="{active: vm.createdResearches.length === 0 && (vm.isAdmin || vm.isTeamLead)}">
          <a href="#submitted" aria-controls="grid" role="tab" data-toggle="tab" ng-click="vm.switchTab('submitted')">Submitted Posters</a>
        </li>
        <li role="presentation" ng-class="{active: vm.createdResearches.length === 0 && !vm.isAdmin && !vm.isTeamLead}">
          <a href="#teamdrafts" aria-controls="grid" role="tab" data-toggle="tab" ng-click="vm.switchTab('teamdrafts')">
            {{(vm.isAdmin || vm.isTeamLead) ? 'Team' : 'Teammate'}} Posters</a>
        </li>
      </ul>
      <div class="tab-content">
        <br />
        <div role="tabpanel" class="tab-pane" id="created" ng-class="{active: vm.createdResearches.length > 0}">
          <div isotope-container="isotope-container" images-loaded>
            <div ng-repeat="createdResearch in vm.createdResearches track by createdResearch._id" isotope-item="isotope-item" class="col-xs-12 col-sm-6 col-md-4 col-lg-3 library-item">
                <div class="panel" data-category="transition" ui-sref="researches.view({ researchId: createdResearch._id })">
                    <div class="panel-body">
                        <p>{{vm.getLongDate(createdResearch.created)}}</p>
                        <h4>{{createdResearch.title}}</h4>
                        <small>{{createdResearch.intro}}</small>
                    </div>
                    <div class="panel-footer">
                        <h6 ng-show="createdResearch.status === 'published'">Published</h6>
                        <h6 ng-show="createdResearch.status === 'draft'">Draft</h6>
                        <h6 ng-show="createdResearch.status === 'pending'" class="blue">Awaiting Approval</h6>
                        <h6 ng-show="createdResearch.status === 'returned'" class="red">Returned</h6>
                    </div>
                </div>
            </div>
          </div>
        </div>
        <div role="tabpanel" class="tab-pane" id="submitted" view-permissions="admin,team lead" ng-class="{active: vm.createdResearches.length === 0 && (vm.isAdmin || vm.isTeamLead)}">
          <div isotope-container="isotope-container" images-loaded>
            <div ng-repeat="pendingResearch in vm.pendingResearches track by pendingResearch._id" isotope-item="isotope-item" class="col-xs-12 col-sm-6 col-md-4 col-lg-3 library-item">
                <div class="panel-overlay">
                    <a class="btn btn-sm btn-primary pull-right" ui-sref="researches.edit({ researchId: pendingResearch._id })">
                        <i class="glyphicon glyphicon-pencil"></i></a>
                    <a class="btn btn-sm btn-danger pull-right" ng-click="vm.openReturnModal(pendingResearch)">
                        <i class="glyphicon glyphicon-remove"></i></a>
                    <a class="btn btn-sm btn-success pull-right" ng-click="vm.openPublishModal(pendingResearch)">
                        <i class="glyphicon glyphicon-ok"></i></a>
                </div>
                <div class="panel" data-category="transition" ui-sref="researches.view({ researchId: pendingResearch._id })">
                    <div class="panel-body">
                        <p>{{vm.getLongDate(pendingResearch.created)}}</p>
                        <h4>{{pendingResearch.title}}</h4>
                        <small>{{pendingResearch.intro}}</small>
                    </div>
                    <div class="panel-footer">
                        <img class="header-profile-image" ng-show="pendingResearch.user && pendingResearch.user.profileImageURL"
                          ng-src="{{pendingResearch.user.profileImageURL}}"/> {{pendingResearch.user.username}}
                        <br/><small><!--Oyster Team,  -->{{pendingResearch.user.schoolOrg.name}}</small>
                    </div>
                </div>
            </div>
          </div>
        </div>
        <div role="tabpanel" class="tab-pane" id="teamdrafts" ng-class="{active: vm.createdResearches.length === 0 && !vm.isAdmin && !vm.isTeamLead}">
          <div isotope-container="isotope-container" images-loaded>
            <div ng-repeat="draftResearch in vm.draftResearches track by draftResearch._id" isotope-item="isotope-item" class="col-xs-12 col-sm-6 col-md-4 col-lg-3 library-item">
                <div class="panel" data-category="transition" ui-sref="researches.view({ researchId: draftResearch._id })">
                    <div class="panel-body">
                        <p>{{vm.getLongDate(draftResearch.created)}}</p>
                        <h4>{{draftResearch.title}}</h4>
                        <small>{{draftResearch.intro}}</small>
                    </div>
                    <div class="panel-footer">
                        <img class="header-profile-image" ng-show="draftResearch.user && draftResearch.user.profileImageURL"
                          ng-src="{{draftResearch.user.profileImageURL}}"/> {{draftResearch.user.username}}
                        <br/><small><!--Oyster Team,  -->{{draftResearch.user.schoolOrg.name}}</small>
                    </div>
                </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</section>

<!-- Modals -->
<return-research research="vm.research" close-function="vm.closeReturnModal"></return-research>
<publish-research research="vm.research" close-function="vm.closePublishModal"></publish-research>
